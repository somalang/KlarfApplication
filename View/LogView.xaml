<Window x:Class="KlarfApplication.View.LogView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:util="clr-namespace:KlarfApplication.Utility"
        Title="📋 Log Viewer" 
        Height="600" Width="900"
        WindowStartupLocation="CenterOwner"
        Background="#FF1E1E1E">

    <Window.Resources>
        <Style x:Key="ToolButtonStyle" TargetType="Button">
            <Setter Property="Margin" Value="2"/>
            <Setter Property="Padding" Value="8,4"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#FF555555"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>

        <Style x:Key="LogListBoxItemStyle" TargetType="ListBoxItem">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="5,2"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ListBoxItem">
                        <Border Background="{TemplateBinding Background}" 
                                BorderThickness="0,0,0,1" 
                                BorderBrush="#FF3E3E42"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#FF3E3E42"/>
                            </Trigger>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Background" Value="#FF007ACC"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 헤더 -->
        <Border Grid.Row="0" Background="#FF007ACC" Padding="10,8">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="📋 Application Logs" 
                           Foreground="White" 
                           FontWeight="Bold" 
                           FontSize="14"
                           VerticalAlignment="Center"/>
                <TextBlock Text="{Binding LogCount, StringFormat=({0} entries)}" 
                           Foreground="White" 
                           Margin="10,0,0,0"
                           VerticalAlignment="Center"
                           FontSize="11"/>
            </StackPanel>
        </Border>

        <!-- 툴바 -->
        <Border Grid.Row="1" Background="#FF2D2D30" Padding="5" BorderBrush="#FF555555" BorderThickness="0,1">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- 필터 버튼 -->
                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <TextBlock Text="Filter:" Foreground="White" VerticalAlignment="Center" Margin="5,0"/>
                    <CheckBox Content="Debug" IsChecked="{Binding ShowDebug}" Foreground="Gray" Margin="5,0" VerticalAlignment="Center"/>
                    <CheckBox Content="Info" IsChecked="{Binding ShowInfo}" Foreground="LightBlue" Margin="5,0" VerticalAlignment="Center"/>
                    <CheckBox Content="Warning" IsChecked="{Binding ShowWarning}" Foreground="Orange" Margin="5,0" VerticalAlignment="Center"/>
                    <CheckBox Content="Error" IsChecked="{Binding ShowError}" Foreground="Red" Margin="5,0" VerticalAlignment="Center"/>
                </StackPanel>

                <!-- 액션 버튼 -->
                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <Button Content="🔄 Refresh" Style="{StaticResource ToolButtonStyle}" Command="{Binding RefreshCommand}" ToolTip="Refresh logs"/>
                    <Button Content="💾 Export" Style="{StaticResource ToolButtonStyle}" Command="{Binding ExportCommand}" ToolTip="Export logs to file"/>
                    <Button Content="🗑️ Clear" Style="{StaticResource ToolButtonStyle}" Command="{Binding ClearCommand}" ToolTip="Clear all logs"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- 로그 리스트 -->
        <ListBox Grid.Row="2"
                 Background="#FF252526"
                 Foreground="White"
                 BorderThickness="0"
                 ItemsSource="{Binding FilteredLogs}"
                 ItemContainerStyle="{StaticResource LogListBoxItemStyle}"
                 ScrollViewer.HorizontalScrollBarVisibility="Auto"
                 ScrollViewer.VerticalScrollBarVisibility="Auto"
                 VirtualizingPanel.IsVirtualizing="True"
                 VirtualizingPanel.VirtualizationMode="Recycling">
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="30"/>
                            <ColumnDefinition Width="140"/>
                            <ColumnDefinition Width="70"/>
                            <ColumnDefinition Width="120"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- 아이콘 -->
                        <TextBlock Grid.Column="0" 
                                   Text="{Binding Level}"
                                   FontSize="14"
                                   VerticalAlignment="Center"
                                   HorizontalAlignment="Center"/>

                        <!-- 타임스탬프 -->
                        <TextBlock Grid.Column="1" 
                                   Text="{Binding Timestamp, StringFormat=yyyy-MM-dd HH:mm:ss}"
                                   Foreground="LightGray"
                                   FontSize="10"
                                   FontFamily="Consolas"
                                   VerticalAlignment="Center"
                                   Margin="5,0"/>

                        <!-- 레벨 -->
                        <TextBlock Grid.Column="2" 
                                   Text="{Binding Level}"
                                   Foreground="{Binding Level}"
                                   FontWeight="Bold"
                                   FontSize="10"
                                   VerticalAlignment="Center"
                                   Margin="5,0"/>

                        <!-- 소스 -->
                        <TextBlock Grid.Column="3" 
                                   Text="{Binding Source}"
                                   Foreground="Cyan"
                                   FontSize="10"
                                   VerticalAlignment="Center"
                                   Margin="5,0"/>

                        <!-- 메시지 -->
                        <TextBlock Grid.Column="4" 
                                   Text="{Binding Message}"
                                   Foreground="White"
                                   FontSize="11"
                                   TextWrapping="Wrap"
                                   VerticalAlignment="Center"
                                   Margin="5,0"/>
                    </Grid>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>

        <!-- 하단 상태바 -->
        <Border Grid.Row="3" Background="#FF555555" Padding="8,4">
            <Grid>
                <TextBlock Text="{Binding StatusMessage}" Foreground="White" FontSize="11" VerticalAlignment="Center"/>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                    <CheckBox Content="Auto-scroll" IsChecked="{Binding AutoScroll}" Foreground="White" VerticalAlignment="Center" Margin="0,0,10,0"/>
                    <TextBlock Text="{Binding FilteredLogCount, StringFormat=Showing: {0}}" Foreground="LightGray" FontSize="11" VerticalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>